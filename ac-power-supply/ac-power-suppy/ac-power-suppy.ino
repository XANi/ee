/*
  Blink

  Turns an LED on for one second, then off for one second, repeatedly.

  Most Arduinos have an on-board LED you can control. On the UNO, MEGA and ZERO
  it is attached to digital pin 13, on MKR1000 on pin 6. LED_BUILTIN is set to
  the correct LED pin independent of which board is used.
  If you want to know what pin the on-board LED is connected to on your Arduino
  model, check the Technical Specs of your board at:
  https://www.arduino.cc/en/Main/Products

  modified 8 May 2014
  by Scott Fitzgerald
  modified 2 Sep 2016
  by Arturo Guadalupi
  modified 8 Sep 2016
  by Colby Newman

  This example code is in the public domain.

  http://www.arduino.cc/en/Tutorial/Blink
*/
#include <avr/sleep.h>
#define maxSamplesNum 2048
PROGMEM const uint16_t sinTable[maxSamplesNum] = {
  // Sin wave
0x400,0x403,0x406,0x409,0x40c,0x40f,0x412,0x415,
0x419,0x41c,0x41f,0x422,0x425,0x428,0x42b,0x42f,
0x432,0x435,0x438,0x43b,0x43e,0x441,0x445,0x448,
0x44b,0x44e,0x451,0x454,0x457,0x45a,0x45e,0x461,
0x464,0x467,0x46a,0x46d,0x470,0x473,0x477,0x47a,
0x47d,0x480,0x483,0x486,0x489,0x48c,0x48f,0x493,
0x496,0x499,0x49c,0x49f,0x4a2,0x4a5,0x4a8,0x4ab,
0x4ae,0x4b2,0x4b5,0x4b8,0x4bb,0x4be,0x4c1,0x4c4,
0x4c7,0x4ca,0x4cd,0x4d0,0x4d3,0x4d7,0x4da,0x4dd,
0x4e0,0x4e3,0x4e6,0x4e9,0x4ec,0x4ef,0x4f2,0x4f5,
0x4f8,0x4fb,0x4fe,0x501,0x504,0x507,0x50a,0x50d,
0x510,0x514,0x517,0x51a,0x51d,0x520,0x523,0x526,
0x529,0x52c,0x52f,0x532,0x535,0x538,0x53b,0x53e,
0x541,0x544,0x547,0x549,0x54c,0x54f,0x552,0x555,
0x558,0x55b,0x55e,0x561,0x564,0x567,0x56a,0x56d,
0x570,0x573,0x576,0x579,0x57c,0x57e,0x581,0x584,
0x587,0x58a,0x58d,0x590,0x593,0x596,0x599,0x59b,
0x59e,0x5a1,0x5a4,0x5a7,0x5aa,0x5ad,0x5af,0x5b2,
0x5b5,0x5b8,0x5bb,0x5be,0x5c0,0x5c3,0x5c6,0x5c9,
0x5cc,0x5ce,0x5d1,0x5d4,0x5d7,0x5da,0x5dc,0x5df,
0x5e2,0x5e5,0x5e8,0x5ea,0x5ed,0x5f0,0x5f3,0x5f5,
0x5f8,0x5fb,0x5fd,0x600,0x603,0x606,0x608,0x60b,
0x60e,0x610,0x613,0x616,0x618,0x61b,0x61e,0x620,
0x623,0x626,0x628,0x62b,0x62e,0x630,0x633,0x636,
0x638,0x63b,0x63d,0x640,0x643,0x645,0x648,0x64a,
0x64d,0x64f,0x652,0x655,0x657,0x65a,0x65c,0x65f,
0x661,0x664,0x666,0x669,0x66b,0x66e,0x670,0x673,
0x675,0x678,0x67a,0x67d,0x67f,0x681,0x684,0x686,
0x689,0x68b,0x68e,0x690,0x692,0x695,0x697,0x69a,
0x69c,0x69e,0x6a1,0x6a3,0x6a5,0x6a8,0x6aa,0x6ad,
0x6af,0x6b1,0x6b3,0x6b6,0x6b8,0x6ba,0x6bd,0x6bf,
0x6c1,0x6c4,0x6c6,0x6c8,0x6ca,0x6cd,0x6cf,0x6d1,
0x6d3,0x6d5,0x6d8,0x6da,0x6dc,0x6de,0x6e0,0x6e3,
0x6e5,0x6e7,0x6e9,0x6eb,0x6ed,0x6f0,0x6f2,0x6f4,
0x6f6,0x6f8,0x6fa,0x6fc,0x6fe,0x700,0x702,0x704,
0x707,0x709,0x70b,0x70d,0x70f,0x711,0x713,0x715,
0x717,0x719,0x71b,0x71d,0x71f,0x721,0x722,0x724,
0x726,0x728,0x72a,0x72c,0x72e,0x730,0x732,0x734,
0x736,0x737,0x739,0x73b,0x73d,0x73f,0x741,0x742,
0x744,0x746,0x748,0x74a,0x74b,0x74d,0x74f,0x751,
0x753,0x754,0x756,0x758,0x759,0x75b,0x75d,0x75f,
0x760,0x762,0x764,0x765,0x767,0x769,0x76a,0x76c,
0x76d,0x76f,0x771,0x772,0x774,0x775,0x777,0x778,
0x77a,0x77c,0x77d,0x77f,0x780,0x782,0x783,0x785,
0x786,0x788,0x789,0x78b,0x78c,0x78d,0x78f,0x790,
0x792,0x793,0x795,0x796,0x797,0x799,0x79a,0x79b,
0x79d,0x79e,0x79f,0x7a1,0x7a2,0x7a3,0x7a5,0x7a6,
0x7a7,0x7a8,0x7aa,0x7ab,0x7ac,0x7ad,0x7af,0x7b0,
0x7b1,0x7b2,0x7b3,0x7b5,0x7b6,0x7b7,0x7b8,0x7b9,
0x7ba,0x7bc,0x7bd,0x7be,0x7bf,0x7c0,0x7c1,0x7c2,
0x7c3,0x7c4,0x7c5,0x7c6,0x7c7,0x7c8,0x7c9,0x7ca,
0x7cb,0x7cc,0x7cd,0x7ce,0x7cf,0x7d0,0x7d1,0x7d2,
0x7d3,0x7d4,0x7d5,0x7d6,0x7d7,0x7d7,0x7d8,0x7d9,
0x7da,0x7db,0x7dc,0x7dc,0x7dd,0x7de,0x7df,0x7e0,
0x7e0,0x7e1,0x7e2,0x7e3,0x7e3,0x7e4,0x7e5,0x7e5,
0x7e6,0x7e7,0x7e7,0x7e8,0x7e9,0x7e9,0x7ea,0x7eb,
0x7eb,0x7ec,0x7ed,0x7ed,0x7ee,0x7ee,0x7ef,0x7ef,
0x7f0,0x7f0,0x7f1,0x7f1,0x7f2,0x7f2,0x7f3,0x7f3,
0x7f4,0x7f4,0x7f5,0x7f5,0x7f6,0x7f6,0x7f7,0x7f7,
0x7f7,0x7f8,0x7f8,0x7f8,0x7f9,0x7f9,0x7f9,0x7fa,
0x7fa,0x7fa,0x7fb,0x7fb,0x7fb,0x7fb,0x7fc,0x7fc,
0x7fc,0x7fc,0x7fd,0x7fd,0x7fd,0x7fd,0x7fd,0x7fe,
0x7fe,0x7fe,0x7fe,0x7fe,0x7fe,0x7fe,0x7ff,0x7ff,
0x7ff,0x7ff,0x7ff,0x7ff,0x7ff,0x7ff,0x7ff,0x7ff,
0x7ff,0x7ff,0x7ff,0x7ff,0x7ff,0x7ff,0x7ff,0x7ff,
0x7ff,0x7ff,0x7ff,0x7fe,0x7fe,0x7fe,0x7fe,0x7fe,
0x7fe,0x7fe,0x7fd,0x7fd,0x7fd,0x7fd,0x7fd,0x7fc,
0x7fc,0x7fc,0x7fc,0x7fb,0x7fb,0x7fb,0x7fb,0x7fa,
0x7fa,0x7fa,0x7f9,0x7f9,0x7f9,0x7f8,0x7f8,0x7f8,
0x7f7,0x7f7,0x7f7,0x7f6,0x7f6,0x7f5,0x7f5,0x7f4,
0x7f4,0x7f3,0x7f3,0x7f2,0x7f2,0x7f1,0x7f1,0x7f0,
0x7f0,0x7ef,0x7ef,0x7ee,0x7ee,0x7ed,0x7ed,0x7ec,
0x7eb,0x7eb,0x7ea,0x7e9,0x7e9,0x7e8,0x7e7,0x7e7,
0x7e6,0x7e5,0x7e5,0x7e4,0x7e3,0x7e3,0x7e2,0x7e1,
0x7e0,0x7e0,0x7df,0x7de,0x7dd,0x7dc,0x7dc,0x7db,
0x7da,0x7d9,0x7d8,0x7d7,0x7d7,0x7d6,0x7d5,0x7d4,
0x7d3,0x7d2,0x7d1,0x7d0,0x7cf,0x7ce,0x7cd,0x7cc,
0x7cb,0x7ca,0x7c9,0x7c8,0x7c7,0x7c6,0x7c5,0x7c4,
0x7c3,0x7c2,0x7c1,0x7c0,0x7bf,0x7be,0x7bd,0x7bc,
0x7ba,0x7b9,0x7b8,0x7b7,0x7b6,0x7b5,0x7b3,0x7b2,
0x7b1,0x7b0,0x7af,0x7ad,0x7ac,0x7ab,0x7aa,0x7a8,
0x7a7,0x7a6,0x7a5,0x7a3,0x7a2,0x7a1,0x79f,0x79e,
0x79d,0x79b,0x79a,0x799,0x797,0x796,0x795,0x793,
0x792,0x790,0x78f,0x78d,0x78c,0x78b,0x789,0x788,
0x786,0x785,0x783,0x782,0x780,0x77f,0x77d,0x77c,
0x77a,0x778,0x777,0x775,0x774,0x772,0x771,0x76f,
0x76d,0x76c,0x76a,0x769,0x767,0x765,0x764,0x762,
0x760,0x75f,0x75d,0x75b,0x759,0x758,0x756,0x754,
0x753,0x751,0x74f,0x74d,0x74b,0x74a,0x748,0x746,
0x744,0x742,0x741,0x73f,0x73d,0x73b,0x739,0x737,
0x736,0x734,0x732,0x730,0x72e,0x72c,0x72a,0x728,
0x726,0x724,0x722,0x721,0x71f,0x71d,0x71b,0x719,
0x717,0x715,0x713,0x711,0x70f,0x70d,0x70b,0x709,
0x707,0x704,0x702,0x700,0x6fe,0x6fc,0x6fa,0x6f8,
0x6f6,0x6f4,0x6f2,0x6f0,0x6ed,0x6eb,0x6e9,0x6e7,
0x6e5,0x6e3,0x6e0,0x6de,0x6dc,0x6da,0x6d8,0x6d5,
0x6d3,0x6d1,0x6cf,0x6cd,0x6ca,0x6c8,0x6c6,0x6c4,
0x6c1,0x6bf,0x6bd,0x6ba,0x6b8,0x6b6,0x6b3,0x6b1,
0x6af,0x6ad,0x6aa,0x6a8,0x6a5,0x6a3,0x6a1,0x69e,
0x69c,0x69a,0x697,0x695,0x692,0x690,0x68e,0x68b,
0x689,0x686,0x684,0x681,0x67f,0x67d,0x67a,0x678,
0x675,0x673,0x670,0x66e,0x66b,0x669,0x666,0x664,
0x661,0x65f,0x65c,0x65a,0x657,0x655,0x652,0x64f,
0x64d,0x64a,0x648,0x645,0x643,0x640,0x63d,0x63b,
0x638,0x636,0x633,0x630,0x62e,0x62b,0x628,0x626,
0x623,0x620,0x61e,0x61b,0x618,0x616,0x613,0x610,
0x60e,0x60b,0x608,0x606,0x603,0x600,0x5fd,0x5fb,
0x5f8,0x5f5,0x5f3,0x5f0,0x5ed,0x5ea,0x5e8,0x5e5,
0x5e2,0x5df,0x5dc,0x5da,0x5d7,0x5d4,0x5d1,0x5ce,
0x5cc,0x5c9,0x5c6,0x5c3,0x5c0,0x5be,0x5bb,0x5b8,
0x5b5,0x5b2,0x5af,0x5ad,0x5aa,0x5a7,0x5a4,0x5a1,
0x59e,0x59b,0x599,0x596,0x593,0x590,0x58d,0x58a,
0x587,0x584,0x581,0x57e,0x57c,0x579,0x576,0x573,
0x570,0x56d,0x56a,0x567,0x564,0x561,0x55e,0x55b,
0x558,0x555,0x552,0x54f,0x54c,0x549,0x547,0x544,
0x541,0x53e,0x53b,0x538,0x535,0x532,0x52f,0x52c,
0x529,0x526,0x523,0x520,0x51d,0x51a,0x517,0x514,
0x510,0x50d,0x50a,0x507,0x504,0x501,0x4fe,0x4fb,
0x4f8,0x4f5,0x4f2,0x4ef,0x4ec,0x4e9,0x4e6,0x4e3,
0x4e0,0x4dd,0x4da,0x4d7,0x4d3,0x4d0,0x4cd,0x4ca,
0x4c7,0x4c4,0x4c1,0x4be,0x4bb,0x4b8,0x4b5,0x4b2,
0x4ae,0x4ab,0x4a8,0x4a5,0x4a2,0x49f,0x49c,0x499,
0x496,0x493,0x48f,0x48c,0x489,0x486,0x483,0x480,
0x47d,0x47a,0x477,0x473,0x470,0x46d,0x46a,0x467,
0x464,0x461,0x45e,0x45a,0x457,0x454,0x451,0x44e,
0x44b,0x448,0x445,0x441,0x43e,0x43b,0x438,0x435,
0x432,0x42f,0x42b,0x428,0x425,0x422,0x41f,0x41c,
0x419,0x415,0x412,0x40f,0x40c,0x409,0x406,0x403,
0x400,0x3fc,0x3f9,0x3f6,0x3f3,0x3f0,0x3ed,0x3ea,
0x3e6,0x3e3,0x3e0,0x3dd,0x3da,0x3d7,0x3d4,0x3d0,
0x3cd,0x3ca,0x3c7,0x3c4,0x3c1,0x3be,0x3ba,0x3b7,
0x3b4,0x3b1,0x3ae,0x3ab,0x3a8,0x3a5,0x3a1,0x39e,
0x39b,0x398,0x395,0x392,0x38f,0x38c,0x388,0x385,
0x382,0x37f,0x37c,0x379,0x376,0x373,0x370,0x36c,
0x369,0x366,0x363,0x360,0x35d,0x35a,0x357,0x354,
0x351,0x34d,0x34a,0x347,0x344,0x341,0x33e,0x33b,
0x338,0x335,0x332,0x32f,0x32c,0x328,0x325,0x322,
0x31f,0x31c,0x319,0x316,0x313,0x310,0x30d,0x30a,
0x307,0x304,0x301,0x2fe,0x2fb,0x2f8,0x2f5,0x2f2,
0x2ef,0x2eb,0x2e8,0x2e5,0x2e2,0x2df,0x2dc,0x2d9,
0x2d6,0x2d3,0x2d0,0x2cd,0x2ca,0x2c7,0x2c4,0x2c1,
0x2be,0x2bb,0x2b8,0x2b6,0x2b3,0x2b0,0x2ad,0x2aa,
0x2a7,0x2a4,0x2a1,0x29e,0x29b,0x298,0x295,0x292,
0x28f,0x28c,0x289,0x286,0x283,0x281,0x27e,0x27b,
0x278,0x275,0x272,0x26f,0x26c,0x269,0x266,0x264,
0x261,0x25e,0x25b,0x258,0x255,0x252,0x250,0x24d,
0x24a,0x247,0x244,0x241,0x23f,0x23c,0x239,0x236,
0x233,0x231,0x22e,0x22b,0x228,0x225,0x223,0x220,
0x21d,0x21a,0x217,0x215,0x212,0x20f,0x20c,0x20a,
0x207,0x204,0x202,0x1ff,0x1fc,0x1f9,0x1f7,0x1f4,
0x1f1,0x1ef,0x1ec,0x1e9,0x1e7,0x1e4,0x1e1,0x1df,
0x1dc,0x1d9,0x1d7,0x1d4,0x1d1,0x1cf,0x1cc,0x1c9,
0x1c7,0x1c4,0x1c2,0x1bf,0x1bc,0x1ba,0x1b7,0x1b5,
0x1b2,0x1b0,0x1ad,0x1aa,0x1a8,0x1a5,0x1a3,0x1a0,
0x19e,0x19b,0x199,0x196,0x194,0x191,0x18f,0x18c,
0x18a,0x187,0x185,0x182,0x180,0x17e,0x17b,0x179,
0x176,0x174,0x171,0x16f,0x16d,0x16a,0x168,0x165,
0x163,0x161,0x15e,0x15c,0x15a,0x157,0x155,0x152,
0x150,0x14e,0x14c,0x149,0x147,0x145,0x142,0x140,
0x13e,0x13b,0x139,0x137,0x135,0x132,0x130,0x12e,
0x12c,0x12a,0x127,0x125,0x123,0x121,0x11f,0x11c,
0x11a,0x118,0x116,0x114,0x112,0x10f,0x10d,0x10b,
0x109,0x107,0x105,0x103,0x101,0xff,0xfd,0xfb,
0xf8,0xf6,0xf4,0xf2,0xf0,0xee,0xec,0xea,
0xe8,0xe6,0xe4,0xe2,0xe0,0xde,0xdd,0xdb,
0xd9,0xd7,0xd5,0xd3,0xd1,0xcf,0xcd,0xcb,
0xc9,0xc8,0xc6,0xc4,0xc2,0xc0,0xbe,0xbd,
0xbb,0xb9,0xb7,0xb5,0xb4,0xb2,0xb0,0xae,
0xac,0xab,0xa9,0xa7,0xa6,0xa4,0xa2,0xa0,
0x9f,0x9d,0x9b,0x9a,0x98,0x96,0x95,0x93,
0x92,0x90,0x8e,0x8d,0x8b,0x8a,0x88,0x87,
0x85,0x83,0x82,0x80,0x7f,0x7d,0x7c,0x7a,
0x79,0x77,0x76,0x74,0x73,0x72,0x70,0x6f,
0x6d,0x6c,0x6a,0x69,0x68,0x66,0x65,0x64,
0x62,0x61,0x60,0x5e,0x5d,0x5c,0x5a,0x59,
0x58,0x57,0x55,0x54,0x53,0x52,0x50,0x4f,
0x4e,0x4d,0x4c,0x4a,0x49,0x48,0x47,0x46,
0x45,0x43,0x42,0x41,0x40,0x3f,0x3e,0x3d,
0x3c,0x3b,0x3a,0x39,0x38,0x37,0x36,0x35,
0x34,0x33,0x32,0x31,0x30,0x2f,0x2e,0x2d,
0x2c,0x2b,0x2a,0x29,0x28,0x28,0x27,0x26,
0x25,0x24,0x23,0x23,0x22,0x21,0x20,0x1f,
0x1f,0x1e,0x1d,0x1c,0x1c,0x1b,0x1a,0x1a,
0x19,0x18,0x18,0x17,0x16,0x16,0x15,0x14,
0x14,0x13,0x12,0x12,0x11,0x11,0x10,0x10,
0xf,0xf,0xe,0xe,0xd,0xd,0xc,0xc,
0xb,0xb,0xa,0xa,0x9,0x9,0x8,0x8,
0x8,0x7,0x7,0x7,0x6,0x6,0x6,0x5,
0x5,0x5,0x4,0x4,0x4,0x4,0x3,0x3,
0x3,0x3,0x2,0x2,0x2,0x2,0x2,0x1,
0x1,0x1,0x1,0x1,0x1,0x1,0x0,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,
0x0,0x0,0x0,0x1,0x1,0x1,0x1,0x1,
0x1,0x1,0x2,0x2,0x2,0x2,0x2,0x3,
0x3,0x3,0x3,0x4,0x4,0x4,0x4,0x5,
0x5,0x5,0x6,0x6,0x6,0x7,0x7,0x7,
0x8,0x8,0x8,0x9,0x9,0xa,0xa,0xb,
0xb,0xc,0xc,0xd,0xd,0xe,0xe,0xf,
0xf,0x10,0x10,0x11,0x11,0x12,0x12,0x13,
0x14,0x14,0x15,0x16,0x16,0x17,0x18,0x18,
0x19,0x1a,0x1a,0x1b,0x1c,0x1c,0x1d,0x1e,
0x1f,0x1f,0x20,0x21,0x22,0x23,0x23,0x24,
0x25,0x26,0x27,0x28,0x28,0x29,0x2a,0x2b,
0x2c,0x2d,0x2e,0x2f,0x30,0x31,0x32,0x33,
0x34,0x35,0x36,0x37,0x38,0x39,0x3a,0x3b,
0x3c,0x3d,0x3e,0x3f,0x40,0x41,0x42,0x43,
0x45,0x46,0x47,0x48,0x49,0x4a,0x4c,0x4d,
0x4e,0x4f,0x50,0x52,0x53,0x54,0x55,0x57,
0x58,0x59,0x5a,0x5c,0x5d,0x5e,0x60,0x61,
0x62,0x64,0x65,0x66,0x68,0x69,0x6a,0x6c,
0x6d,0x6f,0x70,0x72,0x73,0x74,0x76,0x77,
0x79,0x7a,0x7c,0x7d,0x7f,0x80,0x82,0x83,
0x85,0x87,0x88,0x8a,0x8b,0x8d,0x8e,0x90,
0x92,0x93,0x95,0x96,0x98,0x9a,0x9b,0x9d,
0x9f,0xa0,0xa2,0xa4,0xa6,0xa7,0xa9,0xab,
0xac,0xae,0xb0,0xb2,0xb4,0xb5,0xb7,0xb9,
0xbb,0xbd,0xbe,0xc0,0xc2,0xc4,0xc6,0xc8,
0xc9,0xcb,0xcd,0xcf,0xd1,0xd3,0xd5,0xd7,
0xd9,0xdb,0xdd,0xde,0xe0,0xe2,0xe4,0xe6,
0xe8,0xea,0xec,0xee,0xf0,0xf2,0xf4,0xf6,
0xf8,0xfb,0xfd,0xff,0x101,0x103,0x105,0x107,
0x109,0x10b,0x10d,0x10f,0x112,0x114,0x116,0x118,
0x11a,0x11c,0x11f,0x121,0x123,0x125,0x127,0x12a,
0x12c,0x12e,0x130,0x132,0x135,0x137,0x139,0x13b,
0x13e,0x140,0x142,0x145,0x147,0x149,0x14c,0x14e,
0x150,0x152,0x155,0x157,0x15a,0x15c,0x15e,0x161,
0x163,0x165,0x168,0x16a,0x16d,0x16f,0x171,0x174,
0x176,0x179,0x17b,0x17e,0x180,0x182,0x185,0x187,
0x18a,0x18c,0x18f,0x191,0x194,0x196,0x199,0x19b,
0x19e,0x1a0,0x1a3,0x1a5,0x1a8,0x1aa,0x1ad,0x1b0,
0x1b2,0x1b5,0x1b7,0x1ba,0x1bc,0x1bf,0x1c2,0x1c4,
0x1c7,0x1c9,0x1cc,0x1cf,0x1d1,0x1d4,0x1d7,0x1d9,
0x1dc,0x1df,0x1e1,0x1e4,0x1e7,0x1e9,0x1ec,0x1ef,
0x1f1,0x1f4,0x1f7,0x1f9,0x1fc,0x1ff,0x202,0x204,
0x207,0x20a,0x20c,0x20f,0x212,0x215,0x217,0x21a,
0x21d,0x220,0x223,0x225,0x228,0x22b,0x22e,0x231,
0x233,0x236,0x239,0x23c,0x23f,0x241,0x244,0x247,
0x24a,0x24d,0x250,0x252,0x255,0x258,0x25b,0x25e,
0x261,0x264,0x266,0x269,0x26c,0x26f,0x272,0x275,
0x278,0x27b,0x27e,0x281,0x283,0x286,0x289,0x28c,
0x28f,0x292,0x295,0x298,0x29b,0x29e,0x2a1,0x2a4,
0x2a7,0x2aa,0x2ad,0x2b0,0x2b3,0x2b6,0x2b8,0x2bb,
0x2be,0x2c1,0x2c4,0x2c7,0x2ca,0x2cd,0x2d0,0x2d3,
0x2d6,0x2d9,0x2dc,0x2df,0x2e2,0x2e5,0x2e8,0x2eb,
0x2ef,0x2f2,0x2f5,0x2f8,0x2fb,0x2fe,0x301,0x304,
0x307,0x30a,0x30d,0x310,0x313,0x316,0x319,0x31c,
0x31f,0x322,0x325,0x328,0x32c,0x32f,0x332,0x335,
0x338,0x33b,0x33e,0x341,0x344,0x347,0x34a,0x34d,
0x351,0x354,0x357,0x35a,0x35d,0x360,0x363,0x366,
0x369,0x36c,0x370,0x373,0x376,0x379,0x37c,0x37f,
0x382,0x385,0x388,0x38c,0x38f,0x392,0x395,0x398,
0x39b,0x39e,0x3a1,0x3a5,0x3a8,0x3ab,0x3ae,0x3b1,
0x3b4,0x3b7,0x3ba,0x3be,0x3c1,0x3c4,0x3c7,0x3ca,
0x3cd,0x3d0,0x3d4,0x3d7,0x3da,0x3dd,0x3e0,0x3e3,
0x3e6,0x3ea,0x3ed,0x3f0,0x3f3,0x3f6,0x3f9,0x3fc,
  };

// the setup function runs once when you press reset or power the board
void setup() {
  // initialize digital pin LED_BUILTIN as an output.
  pinMode(LED_BUILTIN, OUTPUT);
   setupPWM16();
   setupSinegen();
}


void setupSinegen() {
  //set timer0 interrupt at 2kHz
  TCCR0A = 0;// set entire TCCR0A register to 0
  TCCR0B = 0;// same for TCCR0B
  TCNT0  = 0;//initialize counter value to 0
  // set compare match register for 2khz increments
  OCR0A = 255;// = (16*10^6) / (2000*64) - 1 (must be <256)
  // turn on CTC mode
  TCCR0A |= (1 << WGM01);
  // Set CS01 and CS00 bits for 64 prescaler
  TCCR0B |= (1 << CS01) | (1 << CS00);   
  // enable timer compare interrupt
  TIMSK0 |= (1 << OCIE0A);

  //set timer2 interrupt at 8kHz
  TCCR2A = 0;// set entire TCCR2A register to 0
  TCCR2B = 0;// same for TCCR2B
  TCNT2  = 0;//initialize counter value to 0
  // 50hz * 2048
  OCR2A = 155;
  // turn on CTC mode
  TCCR2A |= (1 << WGM21);
  // Set CS21 bit for 8 prescaler
  TCCR2B |= (1 << CS10);   
  // enable timer compare interrupt
  TIMSK2 |= (1 << OCIE2A);
}

/* Configure digital pins 9 and 10 as 16-bit PWM outputs. */
void setupPWM16() {
    //DDRB |= _BV(PB1) | _BV(PB2);        /* having both on causes more spikes/interference */
    DDRB |= _BV(PB1);        /* set pins as outputs */
    TCCR1A = _BV(COM1A1) /* non-inverting PWM */
        | _BV(COM1B1) | _BV(COM1B0) /* inverting PWM */  
        | _BV(WGM11);                   /* mode 14: fast PWM, TOP=ICR1 */

    TCCR1B = _BV(WGM13) | _BV(WGM12)
        | _BV(CS10);                    /* no prescaling */
    //ICR1 = 0xffff;                      /* TOP counter value */
    //ICR1 = 0x3fff;                      /* TOP counter value */
    ICR1 =0x7ff;
    OCR1A = ICR1 / 2 ;
    OCR1B = ICR1 / 2 ;
        
}

char toggle0 = 0;
ISR(TIMER0_COMPA_vect){
toggle0++;
  if (toggle0 < 200){
   digitalWrite(LED_BUILTIN, HIGH);
  }
  else{
    digitalWrite(LED_BUILTIN, LOW);
  }
}

int sinTablePos = 0;


ISR(TIMER2_COMPA_vect){//update PWM every 2048 * 50 hz
      OCR1A = pgm_read_word(&(sinTable[sinTablePos]));
      OCR1B = OCR1A;
      sinTablePos++;
      if( sinTablePos >= maxSamplesNum ) { sinTablePos = 0 ;}
}


// the loop function runs over and over again forever
void loop() {
//    sleep_enable();
//    set_sleep_mode(SLEEP_MODE_IDLE); 
//      sleep_cpu();    
    delay(1000);
}
